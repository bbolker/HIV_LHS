
\newcommand{\instswitchflowvec}{ 
	\draw[->, very thick] (SI) to (II); 
}

\newcommand{\instswitchepcflowvec}{
	\draw[->, very thick] (SS) to (SI); 
}

\newcommand{\instswitchmixing}{
	\draw[<->, dotted, very thick] (SS) to (pool);
	\draw[<->, dotted, very thick] (SI) to (pool);
	\draw[<->, dotted, very thick] (II) to (pool);
}

\newcommand{\instswitchnoepcinf}{
	\draw[->, blue, dashed, very thick] (SI)
		to [bend right=45] (SItoII);
}

\newcommand{\instswitchepcinf}{
	\draw[->, red, dashed, very thick] (SI)
		to [bend left=45] (SStoSI);
	\draw[->, red, dashed, very thick] (II)
		to [bend left=45] (SItoII);
	\draw[->, red, dashed, very thick] (II)
		to [bend left=70] (SStoSI);
}

\newcommand{\pairformnoepcflowvec}{ 
	\draw[->, very thick] (SI) to (II); 
	\draw[<->, very thick, dotted] (I) to (II); 
	\draw[<->, very thick, dotted] (S) to (SS); 
	\draw[<->, very thick, dotted] (S) to (SI); 
	\draw[<->, very thick, dotted] (I) to (SI); 
}

\newcommand{\pairformepcflowvec}{ 
	\draw[->, very thick] (S) to (I); 
	\draw[->, very thick] (SS) to (SI); 
}

\newcommand{\pairformnoepcinf}{
	\draw[->, blue, dashed, very thick] (SI)
		to [bend right=45] (SItoII);
}

\newcommand{\pairformepcinf}{
	\draw[->, purple, dashed, very thick] (I)
		to [bend right=45] (StoI);
	\draw[->, red, dashed, very thick] (SI)
		to  (StoI);
	\draw[->, red, dashed, very thick] (SI)
		to [bend right=45] (SStoSI);
	\draw[->, red, dashed, very thick] (II)
		to [bend left=60] (SStoSI);
	\draw[->, purple, dashed, very thick] (I)
		to  (SItoII);
	\draw[->, red, dashed, very thick] (II)
		to [bend left=70] (SItoII);
%% these are the problematic ones
% does this help?
%   http://tex.stackexchange.com/questions/209942/curved-arrows-in-tikz
% http://tex.stackexchange.com/questions/40388/avoid-arrow-crossing-over-blocks-in-flow-chart
         \draw[->, red, dashed, very thick] plot [smooth, tension=0.4] coordinates
            { (II.north) ([xshift=0.2cm,yshift=0.2cm]I.north east) 
              ([xshift=-0.5cm,yshift=0.2cm]I.north west) 
              ([yshift=0.25cm]StoI) }
              to (StoI) ;

            \draw[->, purple, dashed, very thick] plot [smooth] coordinates {
             ([yshift=0.3cm]I.west) ([xshift=0.5cm,yshift=0.5cm]S.north east)
             ([xshift=-0.2cm,yshift=0.2cm]S.north west) 
             ([xshift=0.5cm,yshift=0.5cm]SS.north east)
              %% hack to get arrows in the right direction
               ([yshift=0.25cm]SStoSI) } to (SStoSI);

}

\newcommand{\instswitchboxes}[1]{
	\node(SS)[bigcompartment, bottom color = #1]{SS};
	\node(SStoSI)[right=of SS]{};
	\node(SI)[bigcompartment, right=of SStoSI, bottom color = #1]{SI};
	\node(SItoII)[right=of SI]{};
	\node(II)[bigcompartment, right=of SItoII, bottom color = #1]{II};
	\node(pool)[compartment, very thick, above = 10mm of SI, text width = 40mm, align = center, draw = black, bottom color = white, dotted]{temporary mixing pool};
}

\newcommand{\pairformboxes}[1]{
        \node(S)[bigcompartment, bottom color = #1]{S};
        \node(StoI)[right= of S]{};
        \node(I)[bigcompartment,right= of StoI, bottom color = #1]{I};
	\node(SS)[bigcompartment,below left= of S, bottom color = #1]{SS};
	\node(SStoSI)[right=of SS]{};
	\node(SI)[bigcompartment, right=of SStoSI, bottom color = #1]{SI};
	\node(SItoII)[right=of SI]{};
	\node(II)[bigcompartment, right=of SItoII, bottom color = #1]{II};
}


